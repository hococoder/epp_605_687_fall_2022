<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week03/11-UpdatingSwiftUIViews"/><meta name="twitter:url" content="https://hococoder.com/posts/Week03/11-UpdatingSwiftUIViews"/><meta name="og:url" content="https://hococoder.com/posts/Week03/11-UpdatingSwiftUIViews"/><title>Week 3 - Updating SwiftUI Views | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 3 - Updating SwiftUI Views | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 3 - Updating SwiftUI Views | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/epp_605_687_fall_2022/posts/Intro/About Me">AboutMe</a></li><li><a href="/epp_605_687_fall_2022/posts/Intro/Example App">ExampleApp</a></li><li><a href="/epp_605_687_fall_2022/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/epp_605_687_fall_2022/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/epp_605_687_fall_2022/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/epp_605_687_fall_2022/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/epp_605_687_fall_2022/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/epp_605_687_fall_2022/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/epp_605_687_fall_2022/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/epp_605_687_fall_2022/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/epp_605_687_fall_2022/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/epp_605_687_fall_2022/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/epp_605_687_fall_2022/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/epp_605_687_fall_2022/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/epp_605_687_fall_2022/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/epp_605_687_fall_2022/posts/Week13/00-Week13Overview">Week13</a></li><li><a href="/epp_605_687_fall_2022/posts/Week14/00-Week14Overview">Week14</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 3 - Updating SwiftUI Views</h1><p style="float: left">Previous:  <A HREF="../10-SwiftUIImprovements/index.html">SwiftUI Improvements</A></p><p style="float: right">Next:  <A HREF="../../Week04/00-Week04Overview/index.html">Week 4 Overview</A></p><BR/><BR/><h2>Overview</h2><p>Now with an almost fully populated database, let's update the SwiftUI views so they can use the data provided by the database. We'll also take some time to build some new functionality into the app!</p><h2>Making a New <code>CourseClassView</code></h2><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_qns9u3zi?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_qns9u3zi&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><p>First, I'm going to setup the starter code for a new <code>CourseClassView</code>. We want to give the student the chance to see all the possible courses to which they can enroll. So we'll need to define 2 views: one that holds the list of courses the student is enrolled in (with a button to add new classes), and also a view to present the entire list of courses.<br><br>The user experience will be this:</p><ul><li>Inside the <code>ContentView</code>, the classes tab will show the list of currently enrolled courses, as well as an Add button in the Navigation Bar.</li><li>When the user taps on that button, a new view slides over (in a modal fashion) with the list of all courses and an "Enroll" button.</li><li>If the user chooses a course and taps on that button, the class will get associated with that student, the modal dialog will disappear, and the list of enrolled classes will update.</li></ul><p>Let's start with the view that shows all classes. This is different than our original <code>CourseClassView</code> in a few ways: we're taking in information from the database, and also giving the user the chance to choose a class and enroll in it.<br><br><code></code>` import CoreData</p><p>struct CompleteClassListView: View {</p><p>@Environment(.managedObjectContext) var context @Binding var classesToEnroll: Set<String>
  
  @FetchRequest(entity: CourseClassEntity.entity(),
                sortDescriptors: [NSSortDescriptor(keyPath: \CourseClassEntity.courseClassName, ascending: true),
  ]) var availableClasses: FetchedResults<CourseClassEntity>
  
  
  var body: some View {
    let list = availableClasses.map{ $0.courseClassName! }
    
    return NavigationView {
      
      List(selection: $classesToEnroll) {
        
        ForEach(list, id:\.self) { availableClass in
          
          //Finish filling in the functionality in here for homework
          Text(availableClass)
          
        }
      }
    }
  }
}
```


## Making a `EnrolledCourseClassView`

Now for the enrolled list. 

```
struct EnrolledSchoolClassView: View {
  
  @Environment(\.managedObjectContext) var context
  //define a fetch request here to get the student, and use it below
  
  var body: some View {
    return NavigationView {
      
      Text("Replace me - see Programming assignment for what to do!")
      
    }
  }
}
```
So again here, you'll be displaying the list of enrolled classes, adding an Add button to the navigation bar, but when the user taps on that button, the list of classes to choose from will show up in a modal dialog. 

For both of these, don't forget to make the proper queries to the database to get the current data 

## Updating `CoreDataView`

Finally, we can update our `CoreDataView`'s `TabView` a bit.  We'll still use `CourseClassView` for now (later you'll replace this with `EnrolledCourseClassView`), but we'll pass in the first school class from the database (using the `CourseClass` struct's init method to turn it into a `CourseClass` struct). 

For the `AssignmentsView`, again pull from the database, and use the map method to convert each of the retrieved `AssignmentEntity` objects to `Assignment` objects via the `Assignment` initializer.

For the `TeacherView`, build a `Teacher` object from the first teacher in the database. 

For each of the tabs we'll also add an `Image` using Apple's SFSymbols library - see the additions to the `tabItem` closure. 


```
var body: some View {
    TabView(selection: $selection) {
    CourseClassView(schoolClass: CourseClass(schoolClassEntity: schoolClasses.first!)).tabItem { Image(systemName: "calendar") ; Text("Classes") }.tag(1)
      AssignmentsTableView(assignments: assignments.map{ Assignment(assignmentEntity: $0) }).tabItem { Image(systemName: "pencil") ; Text("Assignments") }.tag(2)
      StudentsView(student: ClassAssignmentsModelTestData().students![0]).tabItem { Image(systemName: "person.circle") ; Text("Student") }.tag(3)
      TeacherView(teacher: Teacher(teacherEntity: teachers.first!)).tabItem { Image(systemName: "person.crop.square.fill") ; Text("Teacher") }.tag(4)
    }
  }

```

Before running the simulator you need to do 2 more things:

In ContentView, change from using the `JSONDataView` to the `CoreDataView` near the top of the file

```
struct ContentView: View {

  @State private var selection = 1
  @State var model: AssignmentGraderModel

  var body: some View {
    CoreDataView(selection: $selection, model: $model)
  }
}
```


In LoginView, pass in the new core data model after initializing it:

```
  let dataModel: ClassAssignmentsCoreDataModel

  init() {
    dataModel = ClassAssignmentsCoreDataModel()
    dataModel.loadAllDatabaseData()
  }

  var body: some View {
    viewToDisplay
  }

  @ViewBuilder
  private var viewToDisplay: some View {
    if !userAuth.isLoggedIn {
      LoginView(username: $username, password: $password)
    } else {
      ContentView(model: dataModel)
    }
  }
```

If you run the app in the simulator now, you'll see that it runs, and is pulling data appropriately.  One way to confirm that - look at the Teacher page.  You'll see that there are no values for "Classes Taught".  When the `TeacherEntity` gets initialized, the associations - `activelyTeaching` and `classesTaught`, for example - aren't populated.  We only assigned the actively teaching value earlier, so that shows; we did nothing for classesTaught.  Try it out yourself - go and assign a value for `classesTaught` and see if appears when you restart the app. 

In the programming assignment, you'll finishing wiring things up to move it to a core data based app. 

<p style="float: left">Previous:  <A HREF="../10-SwiftUIImprovements/index.html">SwiftUI Improvements</A></p>
<p style="float: right">Next:  <A HREF="../../Week04/00-Week04Overview/index.html">Week 4 Overview</A></p>
</p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2022-2023 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated August 29, 2022, 9:45 PM</p><p><a href="https://twitter.com/hococoder" target="_blank">My Twitter</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://blackboard.jhu.edu" target="_blank">JHU Blackboard</a></p></footer></body></html>